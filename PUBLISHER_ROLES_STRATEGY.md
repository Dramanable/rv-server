# üè¢ **STRAT√âGIE R√îLES √âDITEUR SAAS - ORGANISATION INTERNE**

## üéØ **CONTEXTE √âDITEUR SAAS**

Vous √™tes **l'entreprise √©ditrice** du logiciel de prise de rendez-vous. Vous avez donc **2 niveaux de gestion** :

1. **üè≠ VOTRE ORGANISATION INTERNE** (Publisher)
2. **üè™ VOS CLIENTS** (Business Tenants)

---

## üè≠ **ARCHITECTURE R√îLES √âDITEUR (PUBLISHER)**

### **üéØ D√âPARTEMENT COMMERCIAL**

#### **Sales Manager (Responsable Commercial)**
```typescript
interface SalesManagerPermissions {
  // üìä Analytics commerciales
  VIEW_SALES_DASHBOARD: boolean;          // Tableau de bord des ventes
  VIEW_SALES_ANALYTICS: boolean;          // M√©triques et KPIs
  VIEW_PIPELINE_REPORTS: boolean;         // Rapports pipeline
  
  // üë• Gestion √©quipe commerciale
  MANAGE_SALES_TEAM: boolean;             // G√©rer l'√©quipe
  ASSIGN_TERRITORIES: boolean;            // Affecter secteurs
  SET_SALES_TARGETS: boolean;             // D√©finir objectifs
  
  // ü§ù Gestion partenaires
  VIEW_PARTNER_PERFORMANCE: boolean;      // Performance partenaires
  APPROVE_PARTNERSHIP_DEALS: boolean;     // Valider accords
  
  // üí∞ Pricing et n√©gociation
  APPROVE_CUSTOM_PRICING: boolean;        // Tarifs sp√©ciaux
  VIEW_COMMISSION_REPORTS: boolean;       // Rapports commissions
}
```

#### **Sales Rep (Commercial Terrain)**
```typescript
interface SalesRepPermissions {
  // üéØ Prospection
  VIEW_ASSIGNED_PROSPECTS: boolean;       // Ses prospects
  CREATE_PROSPECT: boolean;               // Cr√©er prospect
  UPDATE_PROSPECT_STATUS: boolean;        // MAJ statut
  SCHEDULE_DEMO: boolean;                 // Planifier d√©mo
  
  // üìû Actions commerciales
  LOG_SALES_ACTIVITIES: boolean;         // Logger activit√©s
  CREATE_QUOTATION: boolean;             // Cr√©er devis
  SEND_PROPOSALS: boolean;               // Envoyer propositions
  
  // ü§ù Partenaires (limit√©)
  VIEW_ASSIGNED_PARTNERS: boolean;       // Ses partenaires
  CONTACT_PARTNERS: boolean;             // Contacter partenaires
  
  // üìä Reporting
  VIEW_PERSONAL_DASHBOARD: boolean;      // Son tableau de bord
  VIEW_PERSONAL_METRICS: boolean;        // Ses m√©triques
}
```

### **ü§ù D√âPARTEMENT PARTENAIRES**

#### **Partner Manager (Gestionnaire Partenaires)**
```typescript
interface PartnerManagerPermissions {
  // üè¢ Gestion partenaires
  CREATE_PARTNER: boolean;               // Cr√©er partenaire
  UPDATE_PARTNER_INFO: boolean;          // MAJ infos partenaire
  DEACTIVATE_PARTNER: boolean;           // D√©sactiver partenaire
  
  // üíº Programmes partenaires
  MANAGE_PARTNER_PROGRAMS: boolean;      // G√©rer programmes
  SET_COMMISSION_RATES: boolean;         // D√©finir commissions
  APPROVE_PARTNER_DEALS: boolean;        // Valider deals
  
  // üìä Analytics partenaires
  VIEW_PARTNER_DASHBOARD: boolean;       // Dashboard partenaires
  VIEW_PARTNER_PERFORMANCE: boolean;     // Performance
  GENERATE_PARTNER_REPORTS: boolean;     // Rapports
  
  // üéì Formation et support
  MANAGE_PARTNER_TRAINING: boolean;      // Formation partenaires
  PROVIDE_PARTNER_SUPPORT: boolean;      // Support technique
}
```

### **üõ†Ô∏è D√âPARTEMENT SUPPORT**

#### **Support Manager**
```typescript
interface SupportManagerPermissions {
  // üë• Gestion √©quipe support
  MANAGE_SUPPORT_TEAM: boolean;
  ASSIGN_SUPPORT_TICKETS: boolean;
  ESCALATE_TICKETS: boolean;
  
  // üìä Analytics support
  VIEW_SUPPORT_DASHBOARD: boolean;
  VIEW_CUSTOMER_SATISFACTION: boolean;
  GENERATE_SUPPORT_REPORTS: boolean;
  
  // üîß Configuration support
  MANAGE_SUPPORT_CATEGORIES: boolean;
  SET_SLA_PARAMETERS: boolean;
  CONFIGURE_AUTO_RESPONSES: boolean;
}
```

#### **Support Agent**
```typescript
interface SupportAgentPermissions {
  // üé´ Gestion tickets
  VIEW_ASSIGNED_TICKETS: boolean;
  RESPOND_TO_TICKETS: boolean;
  UPDATE_TICKET_STATUS: boolean;
  CREATE_INTERNAL_NOTES: boolean;
  
  // üíª Support technique
  ACCESS_CUSTOMER_ACCOUNTS: boolean;     // Vue admin sur comptes clients
  PERFORM_BASIC_CONFIG: boolean;         // Config de base
  RESET_CUSTOMER_DATA: boolean;          // Reset donn√©es (avec validation)
  
  // üìû Communication
  INITIATE_CUSTOMER_CONTACT: boolean;
  SCHEDULE_SUPPORT_CALLS: boolean;
}
```

---

## üèóÔ∏è **ARCHITECTURE TECHNIQUE RECOMMAND√âE**

### **üéØ ENTIT√â PUBLISHER USER**

```typescript
export class PublisherUser {
  readonly id: PublisherUserId;
  readonly email: Email;
  readonly name: string;
  readonly department: PublisherDepartment;
  readonly role: PublisherRole;
  readonly permissions: PublisherPermission[];
  readonly territory?: SalesTerritory;        // Pour commerciaux
  readonly managedPartners?: PartnerId[];     // Pour partner managers
  readonly isActive: boolean;
  readonly createdAt: Date;
  readonly updatedAt: Date;

  // üéØ M√©thodes m√©tier √©diteur
  canAccessBusinessData(businessId: BusinessId): boolean;
  canManagePartner(partnerId: PartnerId): boolean;
  canViewSalesData(): boolean;
  getAssignedTerritories(): SalesTerritory[];
  hasPermission(permission: PublisherPermission): boolean;
}
```

### **ü§ù ENTIT√â PARTNER**

```typescript
export class Partner {
  readonly id: PartnerId;
  readonly name: string;
  readonly type: PartnerType;              // RESELLER, INTEGRATOR, REFERRER
  readonly contactInfo: ContactInfo;
  readonly commissionRate: number;
  readonly territory: SalesTerritory;
  readonly assignedManager: PublisherUserId;
  readonly performance: PartnerPerformance;
  readonly isActive: boolean;

  // M√©thodes m√©tier partenaires
  calculateCommission(saleAmount: Money): Money;
  canSellInTerritory(territory: SalesTerritory): boolean;
  getPerformanceMetrics(): PartnerMetrics;
}
```

### **üí∞ ENTIT√â SALES OPPORTUNITY**

```typescript
export class SalesOpportunity {
  readonly id: OpportunityId;
  readonly prospectId: ProspectId;
  readonly assignedSalesRep: PublisherUserId;
  readonly partner?: PartnerId;            // Si via partenaire
  readonly stage: SalesStage;              // LEAD, QUALIFIED, PROPOSAL, NEGOTIATION, CLOSED
  readonly value: Money;
  readonly probability: number;            // 0-100%
  readonly expectedCloseDate: Date;
  readonly activities: SalesActivity[];
  readonly customPricing?: PricingDetails;

  // M√©thodes m√©tier ventes
  advanceToNextStage(): void;
  calculateWeightedValue(): Money;
  addActivity(activity: SalesActivity): void;
  applyCustomPricing(pricing: PricingDetails): void;
}
```

---

## üéØ **CAS D'USAGE COMMERCIAUX CONCRETS**

### **üìû Sc√©nario 1 : Commercial d√©marchage**

```typescript
// Commercial terrain ajoute un prospect
export class CreateProspectUseCase {
  async execute(request: CreateProspectRequest): Promise<ProspectResponse> {
    // 1. V√©rifier que le commercial peut cr√©er des prospects
    await this.permissionService.requirePublisherPermission(
      request.salesRepId,
      'CREATE_PROSPECT'
    );
    
    // 2. V√©rifier le territoire
    const salesRep = await this.publisherUserRepo.findById(request.salesRepId);
    if (!salesRep.canWorkInTerritory(request.prospectTerritory)) {
      throw new TerritoryNotAssignedError();
    }
    
    // 3. Cr√©er le prospect
    const prospect = Prospect.create({
      businessName: request.businessName,
      contactInfo: request.contactInfo,
      territory: request.prospectTerritory,
      assignedSalesRep: request.salesRepId,
      source: 'COLD_OUTREACH',
      estimatedValue: request.estimatedValue
    });
    
    return ProspectMapper.toResponse(await this.prospectRepo.save(prospect));
  }
}
```

### **ü§ù Sc√©nario 2 : Partenaire apporte un lead**

```typescript
export class RegisterPartnerLeadUseCase {
  async execute(request: PartnerLeadRequest): Promise<OpportunityResponse> {
    // 1. Valider que le partenaire est actif
    const partner = await this.partnerRepo.findById(request.partnerId);
    if (!partner.isActive()) {
      throw new InactivePartnerError();
    }
    
    // 2. V√©rifier territoire partenaire
    if (!partner.canSellInTerritory(request.leadTerritory)) {
      throw new PartnerTerritoryMismatchError();
    }
    
    // 3. Cr√©er l'opportunit√© avec commission partenaire
    const opportunity = SalesOpportunity.create({
      prospectId: request.prospectId,
      partnerId: request.partnerId,
      assignedSalesRep: partner.getAssignedManager(),
      stage: SalesStage.QUALIFIED, // Les leads partenaires sont pr√©-qualifi√©s
      value: request.estimatedValue,
      partnerCommissionRate: partner.getCommissionRate()
    });
    
    // 4. Notifier le commercial assign√©
    await this.notificationService.notifyNewPartnerLead(
      partner.getAssignedManager(),
      opportunity
    );
    
    return OpportunityMapper.toResponse(await this.opportunityRepo.save(opportunity));
  }
}
```

### **üìä Sc√©nario 3 : Manager analyse performance**

```typescript
export class GetSalesPerformanceUseCase {
  async execute(request: SalesPerformanceRequest): Promise<SalesPerformanceResponse> {
    // 1. V√©rifier permissions manager
    await this.permissionService.requirePublisherPermission(
      request.managerId,
      'VIEW_SALES_ANALYTICS'
    );
    
    // 2. R√©cup√©rer donn√©es √©quipe
    const manager = await this.publisherUserRepo.findById(request.managerId);
    const teamMembers = await this.publisherUserRepo.findByManager(request.managerId);
    
    // 3. Calculer m√©triques
    const performance = await this.salesAnalyticsService.calculateTeamPerformance({
      teamMembers: teamMembers.map(m => m.getId()),
      period: request.period,
      includePartnerSales: request.includePartners
    });
    
    return {
      teamPerformance: performance,
      individualMetrics: await this.getIndividualMetrics(teamMembers),
      partnerContribution: await this.getPartnerContribution(request.period),
      forecastAccuracy: await this.calculateForecastAccuracy(teamMembers, request.period)
    };
  }
}
```

---

## üîê **SYST√àME PERMISSIONS √âDITEUR**

### **üéØ Matrice Permissions par R√¥le**

| Permission | Sales Manager | Sales Rep | Partner Manager | Support Manager | Support Agent |
|------------|---------------|-----------|-----------------|-----------------|---------------|
| VIEW_ALL_PROSPECTS | ‚úÖ | ‚ùå | ‚ùå | ‚ùå | ‚ùå |
| CREATE_PROSPECT | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| MANAGE_PARTNERS | ‚ùå | ‚ùå | ‚úÖ | ‚ùå | ‚ùå |
| VIEW_CUSTOMER_DATA | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| MODIFY_CUSTOMER_DATA | ‚ùå | ‚ùå | ‚ùå | ‚úÖ | ‚ö†Ô∏è |
| ACCESS_ANALYTICS | ‚úÖ | ‚ö†Ô∏è | ‚úÖ | ‚úÖ | ‚ùå |

**‚úÖ = Acc√®s complet** | **‚ö†Ô∏è = Acc√®s limit√©** | **‚ùå = Pas d'acc√®s**

---

## üéØ **ENDPOINTS D√âDI√âS √âDITEUR**

```typescript
// üè≠ Publisher Admin
@Controller('publisher/admin')
export class PublisherAdminController {
  @Get('dashboard')                    // Vue d'ensemble √©diteur
  @Get('customers')                    // Liste clients
  @Get('revenue-analytics')            // Analytics revenus
  @Put('platform-settings')           // Config plateforme
}

// üíº Sales & Commercial
@Controller('publisher/sales')
export class PublisherSalesController {
  @Get('prospects')                    // Pipeline prospects
  @Post('prospects')                   // Cr√©er prospect
  @Get('opportunities')                // Opportunit√©s commerciales
  @Put('opportunities/:id/advance')    // Faire avancer le deal
  @Get('quotations')                   // Devis g√©n√©r√©s
  @Get('performance')                  // Performance commerciale
}

// ü§ù Partners
@Controller('publisher/partners')
export class PartnerController {
  @Get('')                            // Liste partenaires
  @Post('')                           // Cr√©er partenaire
  @Get(':id/performance')             // Performance partenaire
  @Put(':id/commission-rate')         // MAJ taux commission
  @Get('leads')                       // Leads apport√©s par partenaires
}

// üõ†Ô∏è Support
@Controller('publisher/support')
export class PublisherSupportController {
  @Get('tickets')                     // Tickets support
  @Get('customers/:id/account')       // Vue admin compte client
  @Post('customers/:id/actions')      // Actions support (reset, config)
  @Get('satisfaction-metrics')        // M√©triques satisfaction
}
```

---

## üí° **RECOMMANDATIONS STRAT√âGIQUES**

### **üéØ PRIORISATION D√âVELOPPEMENT**

1. **PHASE 1** : R√¥les commerciaux de base (Sales Manager/Rep)
2. **PHASE 2** : Syst√®me partenaires complet
3. **PHASE 3** : Support client avanc√©
4. **PHASE 4** : Analytics et reporting avanc√©s

### **üîß INT√âGRATIONS RECOMMAND√âES**

- **CRM** : Int√©gration Salesforce/HubSpot pour pipeline
- **Facturation** : Stripe/Chargebee pour billing
- **Analytics** : Mixpanel/Amplitude pour m√©triques usage
- **Support** : Zendesk/Intercom pour tickets
- **Communication** : Slack/Teams pour notifications internes

Cette architecture vous donne une **organisation commerciale professionnelle** avec gestion des partenaires, pipeline de ventes, et support client int√©gr√©. 

Voulez-vous que je commence par impl√©menter une partie sp√©cifique (commerciaux, partenaires, ou support) ?